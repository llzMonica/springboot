<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>大麦商城</title>
<link href="css/common.css"
	rel="stylesheet" type="text/css" />
<link href="css/register.css"
	rel="stylesheet" type="text/css" />
	<link href="css/check.css"
		  rel="stylesheet" type="text/css"/>
<script type="text/javascript"
	src="js/jquery-1.8.3.js"></script>
	<script type="text/javascript" src="js/axios.min.js"></script>
	<script type="text/javascript" src="js/vue.min.js"></script>
	<script type="text/javascript" src="js/comp.js"></script>
	<script type="text/javascript" src="js/alter.js"></script>
</head>
<body>
	<div class="container header">
		
<div class="span5">
		<div class="logo">
			<a href="index.html">
				<img src="image/r___________renleipic_01/logo.png" alt="依依不舍"/>
			</a>
		</div>
	</div>
	<div class="span9">
<div class="headerAd">
	<img src="image/header.jpg" width="320" height="50" alt="正品保障" title="正品保障"/>
</div>	</div>
<div class="span10 last">
		<div class="topNav clearfix">
			<ul id="loginUser">


				<li v-if="loginUser.cname" id="headerLogin" class="headerLogin" style="display: list-item;">
					<a href="personal.html">我:{{loginUser.cname}}</a>|
				</li>
				<li v-else id="headerLogins" class="headerLogin" style="display: list-item;">
					<a href="login.html">登录</a>|
				</li>
				<li id="headerRegister" class="headerRegister" style="display: list-item;">
					<a href="reg.html">注册</a>|
				</li>
				
				
				
				<li id="headerUsername" class="headerUsername"></li>
				<li id="headerLogout" class="headerLogout">
					<a>[退出]</a>|
				</li>
						<li>
							<a>会员中心</a>
							|
						</li>
						<li>
							<a>购物指南</a>
							|
						</li>
						<li>
							<a>关于我们</a>
							
						</li>
			</ul>
			<script type="text/javascript">
				var user= new Vue({
					el:"#loginUser",
					data:{
						loginUser:{

						}
					},
					created:function () {
						axios({
							url:"user.do?op=getUser",
						}).then((res)=>{
							this.loginUser=res.data;
							console.info(this.loginUser)
						})
					}
				})
			</script>
		</div>
		<div class="cart">
			<a  href="cart.html">购物车</a>
		</div>
			<div class="phone">
				客服热线:
				<strong>96008/53277764</strong>
			</div>
	</div>
		


<div class="span24">
		<ul class="mainNav">
					<li>
						<a href="index.html">首页</a>
						|
					</li>
					
					<li>
<a href="clist.html?1&pageIndex=1">
					女装男装
</a>
					|</li>
					
					<li>
<a href="clist.html?2&pageIndex=1">
					鞋靴箱包
</a>
					|</li>
					
					<li>
<a href="clist.html?3&pageIndex=1">
					运动户外
</a>
					|</li>
					
					<li>
<a href="clist.html?4&pageIndex=1">
					珠宝配饰
</a>
					|</li>
					
					<li>
<a href="clist.html?5&pageIndex=1">
					手机数码
</a>
					|</li>
					
					<li>
<a href="clist.html?6&pageIndex=1">
					家电办公
</a>
					|</li>
					
					<li>
<a href="clist.html?7&pageIndex=1">
					护肤彩妆
</a>
					|</li>
							
		</ul>
	</div>


	</div>
	<div class="container register">
		<div class="span24">
			<div class="wrap">
				<div class="main clearfix">
					<div class="title">
						<a href="personal.html"><strong>个人中心</strong>PERSONAL</a>
						<strong>安全设置</strong>SETTINGS
						<a href="footstep.html"><strong>我的足迹</strong>FOOTPRINT</a>
						<a href="collection.html"><strong>我的收藏</strong>COLLECTIONS</a>
					</div>
					<form id="personalForm"
						action="reg.html"
						method="post" novalidate="novalidate"
						onsubmit="return checkForm();">
						<table>
								<tr >
									<th><span class="requiredField"></span>旧密码&nbsp;:</th>
									<td><input v-model="oldPass" type="password" id="oldpassword" name="password"
										class="text" maxlength="20" autocomplete="off"  disabled="disabled"/>
										<span>
									</span></td>
								</tr>
								<tr >
									<th><span class="requiredField"></span>新密码&nbsp;:</th>
									<td><input v-model="newPass" type="password" id="password"
										name="repassword" class="text" maxlength="20"
										autocomplete="off" onblur="checkpwd(this.value)" disabled="disabled"/>
										<div id="pwdResult" style="display: none"></div>
									</td>
								</tr>
								<tr>
									<th><span class="requiredField"></span>确认密码:</th>
									<td><input v-model="reupass" type="password" id="repassword"
											   name="repassword" class="text" maxlength="20"
											   autocomplete="off" onblur="checkrepwd(this.value)" disabled="disabled"/>
										<div id="repwdResult" style="display: none"></div>
									</td>
								</tr>
								<tr>
									<th></th>
									<td v-if="flag===1"><span class="fieldSet">
											<input @click="edit1" type="button" class="submit" value="修改密码">
										</span>
									</td>
									<td v-else><span class="fieldSet">
											<input @click="alterPass"  type="button" class="submit" value="确认修改密码">
										</span>
									</td>
								</tr>
								<tr>
									<th ><span class="requiredField"></span>邮箱:</th>
										<td>
											<label id="email">{{loginUser.email}}</label>
											<span id="span1"></span>
										</td>
								</tr>
								<tr>
									<th><span class="requiredField"></span>新邮箱:</th>
									<td><input  type="text" id="email1" name="email" v-model="email"
												class="text" maxlength="200"  onblur="checkemail(this.value)" />
										<div id="emailResult" style="display: none"></div>
									</td>
								</tr>
								<tr>
									<th><span class="requiredField"></span>验证码:</th>
									<td><span class="fieldSet">
										<input v-model="code" type="text" id="captcha" name="captcha" class="text captcha"
																	   maxlength="6" autocomplete="off">
										<input @click="getCode"  type="button"  value="获取邮箱验证码">
																	</span></td>
								</tr>
								<tr>
									<th></th>
									<td><span class="fieldSet">
											<input @click="alterEmail" type="button" class="submit" value="修改邮箱地址">
										</span>
									</td>
								</tr>
								<tr>
									<th ><span class="requiredField"></span>手机号码:</th>
									<td>
										<label id="phone">{{loginUser.phone}}</label>
									</td>
								</tr>
								<tr>
									<th><span class="requiredField"></span>新手机号:</th>
									<td><input  type="text" id="phone2" name="phone" v-model="phone"
												class="text" maxlength="200"  onblur="checkphone(this.value)" />
										<div id="phoneResult" style="display: none"></div>
									</td>
								</tr>
								<tr>
									<th><span class="requiredField"></span>验证码:</th>
									<td><span class="fieldSet">
										<input v-model="phoneCode" type="text" id="code" name="captcha" class="text captcha"
																			   maxlength="6" autocomplete="off">
										<input @click="getPhoneCode"   type="button"  value="获取手机验证码">
																									</span></td>
								</tr>
								<tr>
									<th></th>
									<td><span class="fieldSet">
										<input @click="alterPhone" type="button" class="submit" value="修改手机号吗">
																		</span>
									</td>

								</tr>

							</tbody>
						</table>
					</form>
					<script type="text/javascript">
						var user= new Vue({
							el:"#personalForm",
							data:{
								loginUser:{
									email:"",
									phone:"",
									ename:""

								},
								oldPass:"",
								newPass:"",
								reupass:"",
								email:"",
								code:"",
								phone:"",
								phoneCode:"",
								flag:1
							},
							created:function () {
								axios({
									url:"user.do?op=getUser",
								}).then((res)=>{
									this.loginUser=res.data;
									console.info(this.loginUser)
								})
							},
							methods:{
								edit1(){
									this.flag=2;
									$("oldpassword").removeAttribute("disabled");
									$("password").removeAttribute("disabled");
									$("repassword").removeAttribute("disabled");
								},
								alterPass(){
									axios({
										url:"user.do?op=alterPass",
										params:{
											oldPass: this.oldPass,
											newPass: this.newPass
										}
									}).then((res)=>{
										alert(res.data.msg);
										if (res.data.code){
											location.href="login.html"
										}
									})
								},
								getCode() {
									axios({
										url:"check.do?op=getCode",
										params: {
											email:this.email,
										}
									}).then((res)=>{
										alert(res.data.msg)
									})
								},
								alterEmail(){
									axios({
										url:"user.do?op=alterEmail",
										params:{
											email:this.email,
											code: this.code
										}
									}).then((res)=>{
										alert(res.data.msg);
										if (res.data.code){
											//部分数据刷新
											axios({
												url:"user.do?op=getUser",
											}).then((res)=>{
												this.loginUser=res.data;
												console.info(this.loginUser)
											})
										}
									})
								},
								getPhoneCode(){
									axios({
										url:"check.do?op=getPhoneCode",
										params:{
											phone:this.phone,
										}
									}).then((res)=>{
										alert(res.data.msg);
									})
								},
								alterPhone(){
									axios({
										url:"user.do?op=alterPhone",
										params:{
											phone:this.phone,
											phoneCode: this.phoneCode
										}
									}).then((res)=>{
										alert(res.data.msg)
										if (res.data.code){
											//部分数据刷新
											axios({
												url:"user.do?op=getUser",
											}).then((res)=>{
												this.loginUser=res.data;
												console.info(this.loginUser)
											})
										}
									})
								}

							},

						})
					</script>
				</div>
			</div>
		</div>
	</div>
	<div id="footer">
		<page-foot></page-foot>
	</div>

	<script type="text/javascript">
		new Vue({el:"#footer"});
	</script>
	<div id="_my97DP"
		style="position: absolute; top: -1970px; left: -1970px;">
		<iframe style="width: 190px; height: 191px;"
			src="./会员注册 - Powered By Mango Team_files/My97DatePicker.htm"
			frameborder="0" border="0" scrolling="no"></iframe>
	</div>
</body>
</html>